<div class="add-task fade-in mb-3 border rounded-3 p-3 bg-light">
  <div class="row g-2 align-items-center">
    
    <!-- 事项名称 -->
    <div class="col-md-4">
      <input type="text" 
             class="form-control" 
             placeholder="事项名称" 
             [(ngModel)]="task.name" />
    </div>

    <!-- 时间 -->
    <div class="col-md-5 d-flex align-items-center gap-2">
      <input type="time" class="form-control" [(ngModel)]="task.startTime" />
      <span>～</span>
      <input type="time" class="form-control" [(ngModel)]="task.endTime" />
    </div>

    <!-- 重要度 -->
    <div class="col-md-3">
      <select class="form-select" [(ngModel)]="task.priority">
        <option value="" disabled>重要度</option>
        <option value="重要">重要</option>
        <option value="紧急">紧急</option>
        <option value="不重要・不紧急">不重要・不紧急</option>
      </select>
    </div>
  </div>

  <!-- 共享任务 -->
  <div class="mt-3">
    <label class="form-check-label fw-bold">
      <input class="form-check-input me-2" 
             type="checkbox" 
             [(ngModel)]="task.isShared">
      共享任务（组员可见）
    </label>
  </div>

  <!-- 共享成员选择 -->
  <div *ngIf="task.isShared" class="mt-3 ms-3">
    <div class="fw-bold mb-1">选择共享成员：</div>

    <div *ngFor="let m of members" class="form-check mb-1">
      <input class="form-check-input"
             type="checkbox"
             [checked]="selectedMembers.includes(m.uid)"
             (change)="toggleMember(m.uid)"
             [disabled]="m.uid === currentUid" />

      <label class="form-check-label">
        {{ m.name || m.email }}
        <span *ngIf="m.uid === currentUid" class="text-muted">(自己)</span>
      </label>
    </div>
  </div>

  <!-- 按钮 -->
  <div class="mt-3 text-end">
    <button class="btn btn-primary btn-sm me-2" (click)="addTask()">
      <img src="assets/icon/check-line.svg" width="20" height="20" alt="ok" />
    </button>
    <button class="btn btn-outline-secondary btn-sm" (click)="cancel.emit()">
      <img src="assets/icon/close-large-line.svg" width="20" height="20" alt="cancel" />
    </button>
  </div>
</div>
