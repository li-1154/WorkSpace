<div class="page-section">
    <div class="toolbar">
        <div class="search-wrapper">
            <input type="text" class="search-input" placeholder="ÊêúÁ¥¢ÂïÜÂìÅÂêçÁß∞„ÄÅÁºñÂè∑..." (input)="applyFilter($event)" />
        </div>
    </div>

    <div class="product-card" *ngFor="let item of filteredProducts" [ngClass]="{ 'out-of-stock': item.stock === 0 }"
        (click)="toggleSelect(item.code)">


        <div class="row">

            <!-- Â∑¶‰æßÂõæÁâá + ÁºñÂè∑ -->
            <div class="left">
                <img *ngIf="item.imageUrl; else noImg" [src]="item.imageUrl" class="thumb" />
                <ng-template #noImg>
                    <div class="thumb no-img">Êó†Âõæ</div>
                </ng-template>

                <span class="code">{{ item.code }}</span>
                <span class="stock-tag" [ngClass]="getColor(item.stock)">{{ item.stock || 0 }} ‰ª∂</span>
            </div>

            <!-- ‰∏≠Èó¥‰ø°ÊÅØ -->
            <div class="right-info">

                <div class="info-row">
                    <span>ÂêçÁß∞Ôºö</span><strong>{{ item.name }}</strong>
                </div>

                <div class="info-row">
                    <span>JANÔºö</span>{{ item.janId }}
                </div>

                <!-- ÂàÜÁ±ª + È¢úËâ≤ Âêå‰∏ÄË°å -->
                <div class="info-row double">
                    <div><span>ÂàÜÁ±ªÔºö</span>{{ item.categoryName }}</div>
                    <div><span>È¢úËâ≤Ôºö</span>{{ item.colorName }}</div>
                </div>

                <!-- ËøõË¥ß‰ª∑ + Âá∫Ë¥ß‰ª∑ ÂêåË°å -->
                <div class="info-row double">
                    <div><span>ËøõË¥ß‰ª∑Ôºö</span>¬•{{ item.costPrice }}</div>
                    <div><span>Âá∫Ë¥ß‰ª∑Ôºö</span>¬•{{ item.salePrice }}</div>
                </div>

            </div>


            <!-- Âè≥‰æßÊåâÈíÆÔºöÂè™ÊúâÈÄâÊã©Êó∂ÊòæÁ§∫ -->
            <div class="actions" *ngIf="selectedItemId === item.code">
                <button class="btn-in" (click)="openStockModal(item, 'in')">‚ûï ÂÖ•Â∫ì</button>
                <button class="btn-out" (click)="openStockModal(item, 'out')">‚ûñ Âá∫Â∫ì</button>
                <button class="btn-view" (click)="viewHistory(item.code); $event.stopPropagation()">üìÑ ËÆ∞ÂΩï</button>
            </div>

        </div>
    </div>

</div>
<app-stock-adjust-modal *ngIf="showStockModal" [item]="currentItem" [type]="stockMode"
    (submitted)="onStockSubmitted($event)" (closed)="onModalClose()"></app-stock-adjust-modal>